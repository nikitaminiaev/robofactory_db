<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search Basic Object</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
            line-height: 1.6;
        }

        h1 {
            color: #2c3e50;
            font-weight: 500;
            margin-bottom: 30px;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
        }

        h2 {
            color: #34495e;
            font-size: 1.2em;
            margin-top: 30px;
            font-weight: 500;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        th {
            background-color: #f8f9fa;
            font-weight: 500;
            color: #2c3e50;
            width: 200px;
        }

        tr:last-child td,
        tr:last-child th {
            border-bottom: none;
        }

        /* Дополнительные стили для формы поиска */
        #searchForm {
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        label {
            display: block;
            margin-bottom: 10px;
            color: #2c3e50;
            font-weight: 500;
        }

        input[type="text"] {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }

        button {
            background-color: #3498db;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.2s;
        }

        button:hover {
            background-color: #2980b9;
        }

        .error-message {
            color: #e74c3c;
            padding: 20px;
            background: #fdf0ed;
            border-radius: 4px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>Search Basic Object</h1>
    <form id="searchForm">
        <label for="name">Object Name:</label>
        <input type="text" id="name" name="name" required>
        <button type="submit">Search</button>
    </form>

    <div id="result"></div>

    <script>
    $(document).ready(function() {
        $('#searchForm').submit(function(e) {
            e.preventDefault();
            var name = $('#name').val();
            $.getJSON('/api/basic_object?name=' + encodeURIComponent(name), function(data) {
                var resultHtml = '';
                if (data.error_message) {
                    resultHtml = '<div class="error-message">' + data.error_message + '</div>';
                } else if (data.basic_object) {
                    const obj = data.basic_object;
                    resultHtml = `
                        <h2>Search Result:</h2>
                        <table>
                            <tr><th>ID</th><td>${obj.id}</td></tr>
                            <tr><th>Name</th><td>${obj.name}</td></tr>
                            <tr><th>Author</th><td>${obj.author}</td></tr>
                            <tr><th>Description</th><td>${obj.description}</td></tr>
                            ${obj.coordinates ? `<tr><th>Coordinates</th><td>${JSON.stringify(obj.coordinates)}</td></tr>` : ''}
                            ${obj.role ? `<tr><th>Role</th><td>${obj.role}</td></tr>` : ''}
                            ${obj.role_description ? `<tr><th>Role Description</th><td>${obj.role_description}</td></tr>` : ''}
                            ${obj.created_ts ? `<tr><th>Created</th><td>${obj.created_ts}</td></tr>` : ''}
                            ${obj.updated_ts ? `<tr><th>Updated</th><td>${obj.updated_ts}</td></tr>` : ''}
                        </table>`;

                    if (obj.bounding_contour) {
                        resultHtml += `
                            <h2>Bounding Contour</h2>
                            <table>
                                <tr><th>Is Assembly</th><td>${obj.bounding_contour.is_assembly}</td></tr>
                                <tr><th>BREP Files</th><td>${obj.bounding_contour.brep_files}</td></tr>
                            </table>`;
                    }

                    if (obj.children && obj.children.length > 0) {
                        resultHtml += '<h2>Children</h2><ul>';
                        obj.children.forEach(child => {
                            resultHtml += `<li><a href="/basic_object/${child}">${child}</a></li>`;
                        });
                        resultHtml += '</ul>';
                    }

                    if (obj.parents && obj.parents.length > 0) {
                        resultHtml += '<h2>Parents</h2><ul>';
                        obj.parents.forEach(parent => {
                            resultHtml += `<li><a href="/basic_object/${parent}">${parent}</a></li>`;
                        });
                        resultHtml += '</ul>';
                    }
                }
                $('#result').html(resultHtml);
            });
        });
    });
    </script>
</body>
</html>